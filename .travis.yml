language: go
go:
    - 1.14
jobs:
  include:
    -
      stage: 'unit test'
      install:
        - go get golang.org/x/tools/cmd/cover
        - go get github.com/modocache/gover
        - go get github.com/mattn/goveralls
      script:
        - 'make test'
        - 'gover . coverage.txt'
        - '$HOME/gopath/bin/goveralls -coverprofile=coverage.txt -service=travis-ci -repotoken $COVERALLS_TOKEN'
      after_success:
        - bash <(curl -s https://codecov.io/bash)
